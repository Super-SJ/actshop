<extend name="Public:base" />
<block name="css">
    <style>
        .evalute-del{
            margin-left: 290px;
            margin-top: -70px
        }
    </style>
</block>
<block name="main">
    <form class="layui-form" action="{:U('update')}" method="post">
        <div class="layui-form-item">
            <label class="layui-form-label">商品名称</label>
            <div class="layui-input-block">
                <input type="text" name="name" value="{$detail.name}" required  lay-verify="required" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">商品售价</label>
            <div class="layui-input-block">
                <input type="text" placeholder="(元)" value="{$detail.price}" name="price" required  lay-verify="required" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">商品库存</label>
            <div class="layui-input-block">
                <input type="number" name="number" value="{$detail.number}" required  lay-verify="required" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">商品已售</label>
            <div class="layui-input-block">
                <input type="number" name="al_number" value="{$detail.al_number}" required  lay-verify="required" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">商品排序</label>
            <div class="layui-input-block">
                <input type="number"  value="{$detail.order}" placeholder="数值越小越靠前，最小为0" name="order" required  lay-verify="required" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">联系客服</label>
            <div class="layui-input-block">
                <input type="text" value="{$detail.support}" placeholder="填客服联系渠道" name="support" lay-verify="required" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item spe_type_1">
            <div cla="layui-inline">
                <label class="layui-form-label">商品规格1</label>
                <div class="layui-input-inline">
                    <select>
                        <option value="0">尺码</option>
                    </select>
                </div>
            </div>
            <div class="layui-inline">
                <div class="layui-input-inline" style="width: 250%;" >
                    <input type="text" value="{$detail.spe_value_1}"  name="spe_value_1" class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">颜色SKU</label>
            <div class="layui-input-block">
                <volist name="detail.picture_3" id="vo">
                    <img class="layui-upload-img" src="__PUBLIC__/images/{$vo}">
                </volist>
                <input type="hidden" name="picture_value_3" value="{$detail.picture_value_3}">
            </div>
            <div class="layui-input-block">
                <div class="layui-upload">
                    <button type="button" class="layui-btn" id="photo3">上传</button><span style="padding-left: 5px">针对颜色规格的图片上传,没有颜色规格即可不用上传</span>
                    <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;">
                        预览图：
                        <div class="layui-upload-list" id="demo3"></div>
                    </blockquote>
                </div>
                <input id='photo_value3' type="hidden" name="photo_value3" value="">
            </div>
        </div>
        <div class="layui-form-item spe_type_2">
            <div cla="layui-inline">
                <label class="layui-form-label">商品规格2</label>
                <div class="layui-input-inline">
                    <select>
                        <option value="1">颜色</option>
                    </select>
                </div>
            </div>
            <div class="layui-inline">
                <div class="layui-input-inline" style="width: 250%;" >
                    <input type="text"  value="{$detail.spe_value_2}" name="spe_value_2" class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">商品详情</label>
            <div class="layui-input-block">
                <textarea name="detail" class="layui-textarea">{$detail.detail}</textarea>
            </div>
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">商品主图</label>
            <div class="layui-input-block">
                <volist name="detail.picture_0" id="vo">
                    <img class="layui-upload-img" src="__PUBLIC__/images/{$vo}">
                </volist>
                <input type="hidden" name="picture_value_0" value="{$detail.picture_value_0}">
            </div>
            <div class="layui-input-block">
                <div class="layui-upload">
                    <button type="button" class="layui-btn" id="photo1">上传</button>
                    <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;">
                        预览图：
                        <div class="layui-upload-list" id="demo1"></div>
                    </blockquote>
                </div>
                <input id='photo_value1' type="hidden" name="photo_value1" value="">
            </div>
        </div>
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label">商品详情图</label>
            <div class="layui-input-block">
                <volist name="detail.picture_1" id="vo">
                    <img class="layui-upload-img" src="__PUBLIC__/images/{$vo}">
                </volist>
                <input type="hidden" name="picture_value_1" value="{$detail.picture_value_1}">
            </div>
            <div class="layui-input-block">
                <div class="layui-upload">
                    <button type="button" class="layui-btn" id="photo2">上传</button>
                    <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;">
                        预览图：
                        <div class="layui-upload-list" id="demo2"></div>
                    </blockquote>
                </div>
                <input id='photo_value2' type="hidden" name="photo_value2" value="">
            </div>
        </div>
        <notempty name="detail.evalute">
            <volist name="detail.evalute" id="vo">
                <div class="layui-form-item layui-form-text evalute-div">
                    <label class="layui-form-label">评价   <eq name="key" value="0"><i class="layui-btn layui-btn-sm layui-icon" id="evalute-add">&#xe654;</i></eq></label>
                    <div cla="layui-inline">
                        <div class="layui-input-inline" style="width: 14%;">
                            <input value="{$vo.user}" type="text" placeholder="用户名" name="evaluate_user[]" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-inline">
                        <div class="layui-input-inline" style="width: 254%;">
                            <textarea placeholder="评价内容" class="layui-textarea" name="evaluate_value[]">{$vo.content}</textarea>
                        </div>
                    </div>
                    <gt name="key" value="0">
                        <i class="layui-btn layui-btn-danger layui-btn-sm layui-icon evalute-del">&#x1006;</i>
                    </gt>
                </div>
            </volist>
            <else />
            <div class="layui-form-item layui-form-text evalute-div">
                <label class="layui-form-label">评价   <i class="layui-btn layui-btn-sm layui-icon" id="evalute-add">&#xe654;</i></label>
                <div cla="layui-inline">
                    <div class="layui-input-inline" style="width: 14%;">
                        <input type="text" placeholder="用户名" name="evaluate_user[]" class="layui-input">
                    </div>
                </div>
                <div class="layui-inline">
                    <div class="layui-input-inline" style="width: 254%;">
                        <textarea placeholder="评价内容" class="layui-textarea" name="evaluate_value[]"></textarea>
                    </div>
                </div>
            </div>
        </notempty>
        <input type="hidden" name="id" value="{$detail.id}">
        <div class="layui-form-item">
            <div class="layui-input-block">
                <button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
                <a href="javascript:history.back()" class="layui-btn layui-btn-primary">返回</a>
            </div>
        </div>
    </form>
</block>
<block name="js">
    <script>
        $(function () {
            $('#evalute-add').on('click',function () {
                $('.evalute-div:last').after('<div class="layui-form-item layui-form-text evalute-div"><label class="layui-form-label"></label><div cla="layui-inline"><div class="layui-input-inline" style="width: 14%;"> <input type="text" placeholder="用户名" name="evaluate_user[]" class="layui-input"> </div> </div> <div class="layui-inline"> <div class="layui-input-inline" style="width: 254%;" >  <textarea placeholder="评价内容" class="layui-textarea" name="evaluate_value[]"></textarea> </div> </div><i class="layui-btn layui-btn-danger layui-btn-sm layui-icon evalute-del">&#x1006;</i></div>');
            });
            $(document).on('click','.evalute-del',function () {
                $(this).parents('.evalute-div').remove();
            })
        })
        layui.use('upload', function() {
            var $ = layui.jquery
                , upload = layui.upload;

            //多图片上传
            upload.render({
                elem: '#photo1'
                , url: '{:U("photo_upload")}'
                , multiple: true
                , before: function (obj) {
                    //预读本地文件示例，不支持ie8
                    obj.preview(function (index, file, result) {
                        $('#demo1').append('<img src="' + result + '" alt="' + file.name + '" class="layui-upload-img">')
                    });
                }
                ,  done: function (res) {
                    //上传完毕
                    var value = $('#photo_value1').val();
                    $('#photo_value1').val(value + res.src +",");
                },error:function () {
                    $('#demo1').empty();
                }
            });

            upload.render({
                elem: '#photo2'
                , url: '{:U("photo_upload")}'
                , multiple: true
                , before: function (obj) {
                    //预读本地文件示例，不支持ie8
                    obj.preview(function (index, file, result) {
                        $('#demo2').append('<img src="' + result + '" alt="' + file.name + '" class="layui-upload-img">')
                    });
                }
                , done: function (res) {
                    //上传完毕
                    var value = $('#photo_value2').val();
                    $('#photo_value2').val(value + res.src +",");
                },error:function () {
                    $('#demo2').empty();
                }
            });

            upload.render({
                elem: '#photo3'
                , url: '{:U("photo_upload")}'
                , multiple: true
                , before: function (obj) {
                    //预读本地文件示例，不支持ie8
                    obj.preview(function (index, file, result) {
                        $('#demo3').append('<img src="' + result + '" alt="' + file.name + '" class="layui-upload-img">')
                    });
                }
                , done: function (res) {
                    //上传完毕
                    var value = $('#photo_value3').val();
                    $('#photo_value3').val(value + res.src +",");
                },error:function () {
                    $('#demo3').empty();
                }
            });
        });
    </script>
</block>